# Microsoft-Malware-Detection
Identifying malware from the asm files

Download data from https://www.kaggle.com/c/malware-classification/data?select=train.7z


Notes:

1. Sorry for the inconvinece whole things wasn't on a single notebook,I was working on  this for several weeks and several stages, Order of files to go through MSMalware1 , MSMalware2, MSMalware2

2. My main obective here was to explore different featres that I can explore and reduce the logloss to 0.05, So I haven't included any visulizations that are not necessary (like the data exploration)

3. From winners solutions and other sources I belived that RandomForsest is one of the very good models to get the feature importances and XGBoost works well on dense data than sparse data, Cosidering this and Memory limitations you will find me constanly getting the important features by training a RandomForest and training an XGBoost model on those acquired important features.

4. MSMalware1 notebook is the one where I have tried including the bi_grams, tri_grams, quad_grams and pixel intensities of the byte files.

   4.1  While vectorizing the byte files, I only took the first 10000 cahrs in the file, my main motive is to run train my model on my slighly better than average (16GB ram  + 6 core i7 + Nvidia 1060) machine. The reason I choose the first chars being the winners solution having the first few pixle intensities  proving important and I assumed pixel intensities will somehow correlate with the multi_grams.

   4.2 I have also chose max_features as 5000 during vectorizing for getting each batch of n_grams. ( if we were to get only the tri_grams it would be 256^3 features, also I was desperate to run the code within the memory) 

   4.3  To my utter disappointment I found that all the n_grams of the byte files didn't contribute as much I have expected(logloss of 0.01),  They have only impoved the values slighlty.( I am not sure if this is due to the several depsrate measures I have taken to run the notebook and make it work or the actual features aren't as useful)

5. MSmalware2 is the notebook that I ran on Google Compute Engine with (8 core CPU + 64 GB ram),  

   5.1  To work on Byte Features we have 256 different values and we consider that for (1,4) n_grams that would be  4311810304 features which would to crate memory issues even in GCP for 100 GB of Data( trust me, I have tried it  and found it painfully)  

   5.2 So from the winners solution, I have extracted the opcodes from each line of the asm file and put it as string. Vectorized those strings to get  73654 features for (1,4) n_grams ( as we have only  have 26 unique values fro op_codes). I have run randomforest model on only these features and obtained a verygood logloss.

  5.3  I was uable to install XGboost on GCP, so I have dowloaded that file with important opcode features.

6. MSMalware3 final notebook to run XGBoost using the important opcode features.

  6.1 I have merged asm features, bytes Unigrams and important opcodes features. VOILAAAAA!!!! that seems to make a difference  and those features seem to work well together and we have a logloss of 0.05.
